# 04 组件契约与术语

## 文档契约类型

### `PageSpec`
用于定义单个页面在迁移过程中的最小语义单元。

| 字段 | 类型 | 说明 |
|---|---|---|
| `page_id` | `string` | 页面目录名，例如 `index`、`model-training` |
| `page_goal` | `string` | 页面业务目标（用户在该页要完成什么） |
| `entry_route` | `string` | 对应 `RouteRegistry` 的 routeId |
| `component_tree` | `string[]` | 页面功能区块组件树（L1/L2） |

### `ComponentSpec`
用于定义“功能区块级组件”（非按钮原子组件）。

| 字段 | 类型 | 说明 |
|---|---|---|
| `component_id` | `string` | 组件目录名，例如 `top-dashboard` |
| `region_type` | `enum` | `top/content/bottom/overlay/tab` |
| `inputs` | `string[]` | 输入数据字段，来源于 `pageData[component]` 或静态配置 |
| `outputs` | `string[]` | 输出动作，例如 `route:modelTraining`、`filter:status` |
| `expected_behavior` | `string` | 组件要实现的业务行为与交互预期 |

### `RouteEdgeSpec`
用于描述页面跳转边。

| 字段 | 类型 | 说明 |
|---|---|---|
| `from_page` | `string` | 来源页面 |
| `from_component` | `string` | 触发跳转的组件 |
| `route_id` | `string` | 路由 ID（`shared/router.js`） |
| `to_page` | `string` | 目标页面目录 |

### `FlutterMappingSpec`
用于指导 HTML 功能区块映射到 Flutter Widget。

| 字段 | 类型 | 说明 |
|---|---|---|
| `html_component` | `string` | `page/component` 组合键 |
| `flutter_widget` | `string` | 建议 Flutter Widget 类名 |
| `state_owner` | `enum` | `PageState` 或 `ComponentViewModel` |
| `notes` | `string` | 迁移约束、交互说明、样式注意点 |

## 术语统一

| 术语 | 定义 |
|---|---|
| 功能区块组件 | 按页面业务区域拆分的组件，通常可独立渲染与测试 |
| 页面壳层（PageShell） | `TopRegion + ContentRegion + BottomRegion` 的统一装配结构 |
| 语义路由 | 使用 `routeId` 而非硬编码 html 文件名进行跳转 |
| 事件代理跳转 | 通过 `data-route` + 统一 click 代理触发导航 |
| Mock 模式 | `baseline/stress/edge` 三种数据强度，用于布局健壮性验证 |

## 命名规范

1. 页面目录使用 kebab-case，例如 `question-detail`。
2. 组件目录与组件文件前缀一致，例如 `top-frame/top-frame.html`。
3. routeId 使用 camelCase，例如 `predictionCenter`。
4. Flutter Widget 建议使用 PascalCase，并附带语义后缀：`Region/Section/Card`。

## 迁移约束

1. 不把“功能区块组件”继续拆成按钮级组件再迁移。
2. 保持 `routeId` 作为唯一导航语义源，避免 Flutter 迁移时重新命名。
3. 组件输入以 `ctx.data` 字段为准，不在组件内部隐式拼接业务数据。
4. 页面布局默认单列纵向流，只有 `ActionOverlay` 允许悬浮定位。
5. 可复用组件优先沉淀：`TopFrameRegion`、`StageNavRegion`、`ActionOverlayRegion`、`BottomTabRegion`。
